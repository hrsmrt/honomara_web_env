{% extends "template.html" %}
{% block body %}
<br>
<form id="form-id" action="{{action}}" method="{{method}}">
<input type="number" name="training_id" id="training_id" value="{{training.training_id}}" hidden>
<table>
    <tr>
        <th><label for="date">日付</label></th>
        <td><input type="date" name="date" id="date" value="{{training.date if training != None else today }}" required></td>
    </tr>
    <tr>
        <th><label for="participants">参加者</label></th>
        <td>
            <select id="participants" name="participants" form="form-id" multiple>
            {% set selected_ids = [] if training == None else training.participants|map(attribute='member_id') %}
            {% for grade, members_by_year in members.items() %}
            <optgroup label="{{grade}}年">
                {% for id, member in members_by_year.items() %}
                <option value="{{ id }}"  {{"selected" if id in selected_ids }}>{{member}}</option>
                {% endfor %}
            </optgroup>            
            {% endfor %}
            </select>
        </td>
    </tr>
    <tr>
        <th><label for="place">場所</label></th>
        <td><input type="text" name="place" id="place" value="{{training.place}}" required></label></td>
    </tr>

    <tr>
        <th><label for="weather">天気</label></th>
        <td><input type="text" name="weather" id="weather" value="{{training.weather}}" required></label></td>
    </tr>

    <tr>
        <th><label for="title">タイトル</label></th>
        <td><input type="text" name="title" id="title" value="{{training.title}}" required></label></td>
    </tr>
    
    <tr>
        <th><label for="comment">コメント</label></th>
        <td> <textarea name="comment" id="comment" cols="30" rows="5" value="training.comment"></textarea></td>
    </tr>
</table>
<label for="password">パスワード<input type="password" name="password" id="password" required></label><br>
<label for="submit">submit<input type="submit" value="submit" id="submit"></label>
</form>
<h3>result</h3>
<p>
    {{ request }}
    <br>
    {{ request.form }}
    <br>
    {{ request.form|tojson }}
    <br>
    {{ training }}
    <br>
    {{ request.args }}

</p>
{% endblock body %}
